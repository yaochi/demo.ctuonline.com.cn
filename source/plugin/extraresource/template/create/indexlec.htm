<link rel="stylesheet" href="source/plugin/extraresource/assets/style/extraresource.css?{VERHASH}" type="text/css" />
<div class="mn">
<div class="bm cl">

<h1 class="mt">推荐资源</h1>
<div id="postbox">
<form action="{eval echo join_plugin_action2('createlec')}" autocomplete="off" method="post"  onsubmit="return validate_from(this);" enctype="multipart/form-data">
<input type="hidden" value="2" name="isinnerlec" id="isinnerlec" />
<table width="81%" cellspacing="0" cellpadding="0" border="0" class="tfm" style="width:770px !important;">
  <tbody><tr>
    <th style="border-bottom:1px dashed #d5d5d5;"><strong>资源类型：</strong></th>
    <td style="border-bottom:1px dashed #d5d5d5;">
	<label><input name="extratype" type="radio" value="class" onclick="location.href='forum.php?mod=group&action=plugin&fid=$_G[fid]&plugin_name=extraresource&plugin_op=createmenu&extraresource_action=indexclass';" /> 
	课程</label>
	<label><input name="extratype" type="radio" value="lec" checked="checked"  /> 
	讲师</label>
	<label><input name="extratype" type="radio" value="org"  onclick="location.href='forum.php?mod=group&action=plugin&fid=$_G[fid]&plugin_name=extraresource&plugin_op=createmenu&extraresource_action=indexorg&';" />
	培训机构</label>
	</td>
  </tr>
 </tbody>
 </table>
<!--讲师--> 
<table width="97%" name="lectable" id="lectable"  cellspacing="0" cellpadding="0" border="0" class="tfm tablezykd1" style="margin-top:11px;">
  <tbody>
  <tr>
    <th><strong class="rq y">*</strong><strong>讲师姓名：</strong></th>
	<td id='innerlec' style=" display:none;" ><input type="text" readonly="readonly" name="firstman_names" id="firstman_names" class="px z" style="width: 130px;" ondblclick="showWindow('query', 'misc.php?mod=queryuser&id=firstman_names', 'get', 0);" />
						<input type="hidden" id="firstman_names_uids" name="firstman_names_uids" value="">
						<div class="pns z" style="margin-top: 2px;">
							<button type="button" name="selectMembers" onclick="showWindow('query', 'misc.php?mod=queryuser&id=firstman_names', 'get', 0);" class="pn"><em>选择人员</em></button>
							<button type="button" name="cleanName" onclick="clearname();" class="pn"><em>清空</em></button>
						</div></td>
    <td id='outerlec'><input type="text" class="px" id="lecname" name="lecname" /><span id="checklecturer" style="display:none; padding: 4px; margin-top: 5px; background-color:#FDFF9D;" class="xw1">已找到同名讲师：&nbsp;</span></td>
  </tr>
  <tr>
    <th><strong class="rq y">*</strong><strong>性别：</strong></th>
    <td><label>
      <input name="gender" type="radio" value="0" checked="checked" />
      男</label>
        <label>
          <input name="gender" type="radio" value="1"  />
          女</label></td>
  </tr>
  <tr>
      <th><strong class="rq y">*</strong><strong>教授的课程：</strong></th>
      <td><div id="extraclass"><!--{if $class}--><p><input type="hidden" value="$class[id]" id="classids[]" name="classids[]"><a title="删除此选项" class="delicn y" onclick="deleteorg(this)" href="javascript:;"></a>$class[name]</p><!--{/if}--></div>
	  <a href="#" onclick="showWindow('classwindow', 'misc.php?mod=queryextraclass&fid=$_G[fid]', 'get', 0);"><img src="source/plugin/extraresource/assets/image/zjan.png" width="14" height="15" /> 点击以添加课程</a></td>
    </tr>
    <tr>
    <th><strong>讲师所属机构：</strong></th>
    <td><div id="extraorg"><!--{if $org}--><p><input type="hidden" value="$org[id]" id="orgids[]" name="orgids[]"><input type="hidden" value="$org[name]" id="orgnames[]" name="orgnames[]"><a title="删除此课程" class="delicn y" onclick="deleteorg(this)" href="javascript:;"></a>$org[name]</p><!--{/if}--></div>
	<a href="#" onclick="showWindow('orgwindow', 'misc.php?mod=queryextraorg&fid=$_G[fid]', 'get', 0);"><img src="source/plugin/extraresource/assets/image/zjan.png" width="14" height="15" /> 点击以添加机构</a></td>
  </tr>
    <tr>
      <th><strong class="rq y">*</strong><strong>背景介绍：</strong></th>
      <td valign="top"><textarea class="pt" id="lecdescr" name="lecdescr" cols="40" rows="5"></textarea></td>
    </tr>
    <tr>
      <th><strong>培训经历：</strong></th>
      <td valign="top"><textarea class="pt" id="trainingexperince" name="trainingexperince" cols="40" rows="5"></textarea></td>
    </tr>
	<tr>
      <th><strong>培训特点：</strong></th>
      <td valign="top"><textarea class="pt" id="trainingtrait" name="trainingtrait" cols="40" rows="5"></textarea></td>
    </tr>
	<tr>
      <th><strong class="rq y">*</strong><strong>授课费用：</strong></th>
      <td valign="top"><input class="pt" id="minfee" name="minfee" type="text" style="width:85px;" onkeyup="this.value=this.value.replace(/\D/g,'')" onblur="this.value=this.value.replace(/\D/g,'')" />--<input class="pt" id="maxfee" name="maxfee" type="text" style="width:85px;" onkeyup="this.value=this.value.replace(/\D/g,'')" onblur="this.value=this.value.replace(/\D/g,'')"  />元/天</td>
    </tr>
	<tr>
    <th><strong class="rq y">*</strong><strong>授课方向：</strong></th>
    <td><label>
     <select name="teachdirection" class="ps">
		<option value="1">领导力发展与管理类</option>
		<option value="2">营销类</option>
		<option value="3">技术类</option>
	</select>
    </label></td>
  </tr>
  <tr>
    <th><strong class="rq y">*</strong><strong>讲师照片：</strong></th>
    <td><label>
    		<button type="button" class="pn" onclick="uploadWindow(function (aid, url){updatelecturerattach(aid, url, '{$_G['setting']['attachurl']}home')})"><span>{lang upload}</span></button>
     	</label>    <div id="lecturerattach_image"></div></td>
  </tr>
  <tr>
    <th><strong class="rq y">*</strong><strong>联系电话：</strong></th>
    <td><input type="text" class="px" id="telephone" name="telephone" onblur="checkTel();"> <span class="hongse" id="sdTel" style="display:none;">*格式不正确，请输入正确的电话或手机号码</span></td>
  </tr>
  <tr>
    <th><strong class="rq y">*</strong><strong>Email：</strong></th>
    <td><input type="text" class="px" id="email" name="email" onblur="checkEmail();"><span class="hongse" id="sdEmail" style="display:none;">*格式不正确，请输入正确的邮箱地址</span>	</td>
  </tr>
  <tr>
    <th><strong class="rq y">*</strong><strong>请进行打分：</strong></th>
    <td><table border="0" cellspacing="0" cellpadding="0" class="jsxq_table">
      <tr>
        <td width="80">总体评分：</td>
        <td width="193">
			<ul class="zzjsnet" id="wwwzzjs0">
			<li><a href="javascript:void(0);" class="one-star" star:value="1">1</a></li>
			<li><a href="javascript:void(0);" class="two-stars" star:value="2">2</a></li>
			<li><a href="javascript:void(0);" class="three-stars" star:value="3">3</a></li>
			<li><a href="javascript:void(0);" class="four-stars" star:value="4">4</a></li>
			<li><a href="javascript:void(0);" class="five-stars" star:value="5">5</a></li>
			</ul>
		</td>
        <td width="120"><span id="stars2-tips0" class="result"><b>点击星星评分</b></span>
		<input type="hidden" id="stars2-input0" name="lectotalstars" value="" size="2" /></td>
      </tr>
      <tr>
        <td>授课态度：</td>
        <td>
			<ul class="zzjsnet" id="wwwzzjs1">
			<li><a href="javascript:void(0);" class="one-star" star:value="1">1</a></li>
			<li><a href="javascript:void(0);" class="two-stars" star:value="2">2</a></li>
			<li><a href="javascript:void(0);" class="three-stars" star:value="3">3</a></li>
			<li><a href="javascript:void(0);" class="four-stars" star:value="4">4</a></li>
			<li><a href="javascript:void(0);" class="five-stars" star:value="5">5</a></li>
			</ul>
		</td>
        <td width="163"><span id="stars2-tips1" class="result"><b>点击星星评分</b></span>
		<input type="hidden" id="stars2-input1" name="lecstarsone" value="" size="2" /></td>
      </tr>
      <tr>
        <td>授课思路：</td>
        <td>
			<ul class="zzjsnet" id="wwwzzjs2">
			<li><a href="javascript:void(0);" class="one-star" star:value="1">1</a></li>
			<li><a href="javascript:void(0);" class="two-stars" star:value="2">2</a></li>
			<li><a href="javascript:void(0);" class="three-stars" star:value="3">3</a></li>
			<li><a href="javascript:void(0);" class="four-stars" star:value="4">4</a></li>
			<li><a href="javascript:void(0);" class="five-stars" star:value="5">5</a></li>
			</ul>
		</td>
        <td width="163"><span id="stars2-tips2" class="result"><b>点击星星评分</b></span>
		<input type="hidden" id="stars2-input2" name="lecstarstwo" value="" size="2" /></td>
      </tr>
      <tr>
        <td>授课技巧：</td>
        <td>
			<ul class="zzjsnet" id="wwwzzjs3">
			<li><a href="javascript:void(0);" class="one-star" star:value="1">1</a></li>
			<li><a href="javascript:void(0);" class="two-stars" star:value="2">2</a></li>
			<li><a href="javascript:void(0);" class="three-stars" star:value="3">3</a></li>
			<li><a href="javascript:void(0);" class="four-stars" star:value="4">4</a></li>
			<li><a href="javascript:void(0);" class="five-stars" star:value="5">5</a></li>
			</ul>
		</td>
        <td><span id="stars2-tips3" class="result"><b>点击星星评分</b></span>
		<input type="hidden" id="stars2-input3" name="lecstarsthree" value="" size="2" /></td>
      </tr>
    </table></td>
  </tr>
    <tr>
      <td align="left">&nbsp;</td>
      <td><button class="pn pnp" id="issuance" type="submit"><strong>提交</strong></button></td>
    </tr>
</tbody></table>
<input type="hidden" name="aid" id="aid" tabindex="1" />
<input type="hidden" name="formhash" value="{FORMHASH}" />
</form>

</div></div>
</div>
<script type="text/javascript" src="static/js/home_post.js?{VERHASH}"></script>
<script type="text/javascript" src="source/plugin/extraresource/assets/js/extraresource_common.js?{VERHASH}"></script>
<script>
function deleteorg(obj){
	obj.parentNode.parentNode.removeChild(obj.parentNode);
}
	attachEventListener($("lecname"), "blur", checkDuplicated, false);

function checkDuplicated() {
		$("checklecturer").style.display = "none";
		isDuplicated = false;
		
		var callurl = "forum.php?mod=group"+"&"+"action=plugin&fid="+$_G[fid]+"&plugin_name=extraresource&plugin_op=createmenu&extraresource_action=checklec&name=" + encodeURI($("lecname").value);
		getJSONP(callurl, "processDuplicated");
	}
	
	function processDuplicated(data) {
		for(var i=0;i<data.s.length;i++){
			$("checklecturer").innerHTML="已找到同名讲师：&nbsp;" + "<a href=forum.php?mod=group&action=plugin&fid="+$_G[fid]+"&plugin_name=extraresource&plugin_op=groupmenu&extraresource_action=viewlec&id="+data.s[i]['id']+" target='_blank'>"+data.s[i]['name']+"</a>&nbsp;&nbsp;";
		}
		if(data.s.length>0){
			$("checklecturer").style.display = "block";
		}
	}









function checkEmail(){
     var patrn=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;
	 var cr=document.getElementById('email').value;
	if(cr!=''){
		 if (!patrn.exec(cr))
		   {
			document.getElementById("sdEmail").style.display="";
			$('email').value="";
			$('email').focus();
		   }else{
			document.getElementById("sdEmail").style.display="none";
		   }
		  }	
	  }
function checkTel(){
     var patrn =/^(((\d{11})|(\d{7,8}))|(((0\d{2}-\d{8})|(0\d{3}-\d{7}))|((\(0\d{2}\)\d{8})|(\(0\d{3}\)\d{7}))))$/;
	 var cr=document.getElementById('telephone').value;
	 if(cr!=''){
		 if (!patrn.exec(cr))
		   {
			document.getElementById("sdTel").style.display="";
			$('telephone').value="";
			$('telephone').focus();
		   }else{
			document.getElementById("sdTel").style.display="none";
		   }
	   }
      }  
function clearname() {
		$('firstman_names').value='';
		$('firstman_names_uids').value='';
	}
function validate_from(obj) {
		var lecdescr = $('lecdescr');
		if (lecdescr) {
			var slen = strlen(lecdescr.value);
			if (slen < 1) {
				showDialog("请填写背景介绍");
				lecdescr.focus();
				return false;
			}
		}
		var aid = $('aid');
		if (aid) {
			var slen = strlen(aid.value);
			if (slen < 1 ) {
				showDialog("请上传讲师照片");
				lecdescr.focus();
				return false;
			}
		}
		var extraclass=$('extraclass');
		if(extraclass.innerHTML==''){
			showDialog("请选择课程");
			return false;
		}
		var minfee = $('minfee');
		if (minfee) {
			var slen = strlen(minfee.value);
			if (slen < 1 || slen > 10) {
				showDialog("请填写课程费用下限");
				minfee.focus();
				return false;
			}
		}
		var maxfee = $('maxfee');
		if (maxfee) {
			var slen = strlen(maxfee.value);
			if (slen < 1 || slen > 10) {
				showDialog("请填写课程费用上限");
				maxfee.focus();
				return false;
			}
		}
		if(Number(minfee.value)>Number(maxfee.value)){
				showDialog("课程费用上限不能小于下限");
				maxfee.focus();
				return false;
		}
		var telephone = $('telephone');
		if (telephone) {
			var slen = strlen(telephone.value);
			if (slen < 1) {
				showDialog("请填写联系电话");
				telephone.focus();
				return false;
			}
		}
		var email = $('email');
		if (email) {
			var slen = strlen(email.value);
			if (slen < 1) {
				showDialog("请填写email");
				email.focus();
				return false;
			}
		}
		var isinnerlec=$('isinnerlec').value;
		
		if(isinnerlec=='1'){
			var firstman_names_uids = $('firstman_names_uids');
		  
			if (firstman_names_uids) {
				var slen = strlen(firstman_names_uids.value);
				var str = firstman_names_uids.value;
				/*if(str!=''){
					var x = new Ajax();
					x.myget("misc.php?mod=isteacher"+"&"+"id="+firstman_names_uids.value, function(s){if(s.indexOf("error")>-1){showDialog("该用户已经是讲师");return false;}});
				}*/
				if (slen > 0) {
					if (str.indexOf(',') > 1) {
						showDialog("只能推荐一人成为讲师，请重新选择");
						$('firstman_names').value='';
						$('firstman_names_uids').value='';
						$('firstman_names').focus();
						return false;
					}
				} else {
					showDialog("请选择一个讲师");
					$('firstman_names').focus();
					return false;
				}
			}
		}else{
			var lecname = $('lecname');
			if (lecname) {
				var slen = strlen(lecname.value);
				if (slen < 1) {
					showDialog("请填写讲师姓名");
					lecname.focus();
					return false;
				}
			}
		}
		
		var flag=0;
		for(var i=0;i<4;i++){
			if($('stars2-input'+i).value==''){
				flag++;
			}
		}
		if(flag!=0){
			showDialog("请完成全部打分后提交");
			return false;
		}

	}
</script>

